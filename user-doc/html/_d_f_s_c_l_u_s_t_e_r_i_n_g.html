<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PLUMED: DFSCLUSTERING</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed-code.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.3.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;(cineca-2015)</span></a></li>
      <li><a href="_syntax.html"><span>Getting&#160;started</span></a></li>
      <li><a href="tutorials.html"><span>Tutorials</span></a></li>
      <li><a href="glossary.html"><span>Index&#160;of&#160;Actions</span></a></li>
      <li><a href="cineca.html"><span>Cineca</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_d_f_s_c_l_u_s_t_e_r_i_n_g.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DFSCLUSTERING </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table  align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the adjmat <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=adjmat . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Find the various connected components in an adjacency matrix and then output average properties of the atoms in those connected components.</p>
<p>This collective variable was developed for looking at nucleation phenomena, where you are interested in using studying the behavior of atoms in small aggregates or nuclei. In these sorts of problems you might be interested in the degree the atoms in a nucleus have adopted their crystalline structure or (in the case of heterogenous nucleation of a solute from a solvent) you might be interested in how many atoms are present in the largest cluster.</p>
<p>This collective variable is a function of a multicolvar and as such it must take a multicolvar as input. At first this may seem rather peverse but after a while one hopefully will come to appreciate just how many different properties of the cluster simply by using DFSCLUSTERING in tandem with the different multicolvars. As examples of some things that could be done you could use DFSCLUSTERING in tandem with <a class="el" href="_c_o_o_r_d_i_n_a_t_i_o_n_n_u_m_b_e_r.html">COORDINATIONNUMBER</a> to look at the coordination numbers of the atoms in the largest cluster or you could use DFSCLUSTERING in tandem with <a class="el" href="_q6.html">Q6</a> to look at the crystallinity in the largest cluster. Regardless of what you do, however, this works because a multicolvar is essentially calculating a large number of (we will call them) symmetry functions and each of these symmetry functions can be ascribed to a particular location in space. As an example the symmetry functions calculated by the command <a class="el" href="_c_o_o_r_d_i_n_a_t_i_o_n_n_u_m_b_e_r.html">COORDINATIONNUMBER</a> SPECIES=1-10 are the coordination numbers of atoms 1 through 10. In other words, the first of these symmetry functions measures the number of atoms that are within a certain cutoff of atom 1, the second measures the number of atoms that are within a cutoff of atom 2 and so on. In terms of location it seems logical to suppose that the first of these symmetry functions is located at atom 1's position, the second is at atom 2's position and so on. My point is that from the point of view of DFSCLUSTERING it does not particularly matter what is calculated by the underlying multicolvar. This action operates on the assumption that what we have is a set of positions in space that have a scalar (or vector) quantity associated with them.</p>
<p>Lets summarise thus far: we use multicolvar to convert an atomic configuration into a set of coordinates that have symmetry function values associated with them. Usually this means that we calculate something akin to a coordination number for each of the atoms in our system and that the positions of these ``coordination numbers" are essentially the positions of the atoms. The DFS clustering begins here. We start by calculating an adjacency matrix based on the positions of the various atoms. In other words, we construct an \(n\)-symmetry functions by \(n\)-symmetry functions matrix in which element \(i,j\) is either 0 or 1 and measures whether or not symmetry functions \(i\) and \(j\) are adjacent. As with <a class="el" href="_n_l_i_n_k_s.html">NLINKS</a> or <a class="el" href="_s_p_r_i_n_t.html">SPRINT</a> this measure of adjacency can measure whether or not the positions of the two symmetry functions are within a certain cutoff. Alternatively, if the symmetry functions are vector quanties such as <a class="el" href="_m_o_l_e_c_u_l_e_s.html">MOLECULES</a> or <a class="el" href="_q4.html">Q4</a> it can measure whether the two symmetry functions are within a certain cutoff of each other and whether or not the vector symmetry functions have the same orientation. An important difference between this Action and <a class="el" href="_n_l_i_n_k_s.html">NLINKS</a> or <a class="el" href="_s_p_r_i_n_t.html">SPRINT</a> is that in DFCLUSTERING a hard cutoff is used - although the user inputs a soft switching function the code sets any number that is greater than the tolerance set using the keyword TOL (which is by default machine epsilon) equal to one while any number less than this tolerance is set equal to zero. As a consequence of this we can use the adjacency matrix to determine whether or not a particular pair of atoms are connected or not. We can thus use a DFS clustering algorithm to determine the sizes of the various connected components in the underlying graph. These connected components should then correspond to the various clusters in our system.</p>
<p>Once we have determined which atoms are in each of the connected components of our system we can then determine what the properties of the atoms are in each of the clusters for our system. In other just as we would in any other multicolvar we can determine the average properties of the atoms in the largest cluster. Alternatively, we can determine how many of the atoms in the largest cluster in our system have a coordination number that is greater than a particular threshold and so on. To be clear the mathematics that we use in determining these quantities is identical to that used in multicolvar. The only difference is that now, rather than summing these quantities over all the symmetry functions, we sum only those symmetry functions for the atoms in a particular connected cluster.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>In this example the <a class="el" href="_f_c_c_u_b_i_c.html">FCCUBIC</a> multicolvar is used to determine how similar the environment around each atom is to an FCC unit cell. DFS clustering is used with the adjacency matrix constructed using the switching function specified by SWITCH={CUBIC D_0=0.4 D_MAX=0.5} - in pratice this means the clustering algorithm views two atoms as connected as long as they are within 0.5 nm of each other (as the tolerance is machine epsilon). The final quantity calculated measures the number of atoms in the largest cluster that have an FCCUBIC parameter greater than 0.035.</p>
<pre class="fragment">cubic1: FCCUBIC SPECIES=1-1000 SWITCH={CUBIC D_0=0.4  D_MAX=0.5} 
clust: DFSCLUSTERING DATA=cubic1 CLUSTER=1 SWITCH={CUBIC D_0=0.4   D_MAX=0.5} MORE_THAN={CUBIC D_0=0.035  D_MAX=0.045}
</pre><p>This second example adds a layer of complexity to the previous one. Once again the <a class="el" href="_f_c_c_u_b_i_c.html">FCCUBIC</a> multicolvar is used to determine how similar the environment around each atom is to an FCC unit cell. However, in this case the intervening <a class="el" href="_m_f_i_l_t_e_r__m_o_r_e.html">MFILTER_MORE</a> means that when the clustering is performed by DFSCLUSTERING only those atoms from the <a class="el" href="_f_c_c_u_b_i_c.html">FCCUBIC</a> action that have an fcccubic switching function greater than 0.045 are explicitly clustered using the DFS algorithm. As described on the manual page for <a class="el" href="_m_f_i_l_t_e_r__m_o_r_e.html">MFILTER_MORE</a> this command takes each of the various symmetry functions input by the input multicolvar (in this case the FCCUBIC multicolvar labelled cubic1) and ascribes each of them a weight, \(w_i\) using: </p><p class="formulaDsp">
\[ w_i = 1.0 - s( v_i ) \]
</p>
<p> where \(v_i\) is the value of the \(i\)th symmetry function and \(s()\) is the switching function specified through the SWITCH keyword. Within the DFSCLUSTERING these continuous switching functions have to be converted into discrete (discontinuous) switching functions, which is done through the WTOL keyword. The value given to this keyword ensures that any symmetry function calculated by cubic1 whose weight (calculated by MFILTER_MORE) is less than 0.03 is ignored during the DFS clustering.</p>
<p>Once again the final quantity to be calculated here is the number of atoms in the largest cluster that have an FCCUBIC parameter greater than 0.035. There is a very important and subtle distinction between what is being calculated here and what was calculated in the first example, however. The difference is best understood by considering an example. Imagine we had a very large extended but largely disordered cluster of atoms. By virtue of sheer blind luck a few widely-spaced atoms in this disordered cluster would have a configuration around them that might be very similar to the structure inside an fcc crystal. This despite the fact that the overall structure of the cluster does not resemble an fcc crystal. Suppose that this were clustered using the first command above. The final result you would get would be equal to the number of fcc-like atoms in the disordered cluster as essentially all the atoms in the system are connected - the fact that there is not an ordered arrangement is not particularly important. Now suppose instead that this structure were analysed using the command below. The final value of this quantity would most likely be equal to one as it is unlikely that two of the fcc-like atoms are close together in the cluster. The point is that by inserting the MFILTER_MORE command we have restricted the DFS clustering to only those atoms that are reasonably close in structure to fcc. These atoms are not necessarily close together in are disordered agregate and are thus not necessarily connected.</p>
<pre class="fragment">cubic1: FCCUBIC SPECIES=1-1000 SWITCH={CUBIC D_0=0.4  D_MAX=0.5} TOL=0.03 #MEAN
cf: MFILTER_MORE DATA=cubic1 SWITCH={CUBIC D_0=0.035 D_MAX=0.045}
clust: DFSCLUSTERING DATA=cf WTOL=0.03 CLUSTER=1 SWITCH={CUBIC D_0=0.4   D_MAX=0.5} MORE_THAN={CUBIC D_0=0.035  D_MAX=0.045}
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective variables</a></li><li class="navelem"><a class="el" href="contactmatrix.html">Exploiting contact matrices</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
