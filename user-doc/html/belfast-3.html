<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PLUMED: Belfast tutorial: Adaptive variables II</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed-code.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.3.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;(cineca-2015)</span></a></li>
      <li><a href="_syntax.html"><span>Getting&#160;started</span></a></li>
      <li><a href="tutorials.html"><span>Tutorials</span></a></li>
      <li><a href="glossary.html"><span>Index&#160;of&#160;Actions</span></a></li>
      <li><a href="cineca.html"><span>Cineca</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('belfast-3.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Belfast tutorial: Adaptive variables II </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="belfast-3-aims"></a>
Aims</h1>
<p>The aim of this tutorial is to consolidate the material that was covered during <a class="el" href="belfast-1.html">Belfast tutorial: Analyzing CVs</a> and <a class="el" href="belfast-2.html">Belfast tutorial: Adaptive variables I</a> on analysing trajectories using collective variables and path collective variables. We will then build on this material by showing how you can use the multidimensional scaling algorithm to automate the process of finding collective variables.</p>
<h1><a class="anchor" id="belfast-3-lo"></a>
Learning Outcomes</h1>
<p>Once this tutorial is completed students will:</p>
<ul>
<li>Know how to load colvar data into the GISMO plugin</li>
<li>Know how to run the multidimensional scaling algorithms on a trajectory</li>
<li>Be able to explain how we can automate the process of finding collective variables by seeking out an isometry between a high-dimensional and low-dimensional space</li>
</ul>
<h1><a class="anchor" id="belfast-3-resources"></a>
Resources</h1>
<p>The <a href="tutorial-resources/belfast-3.tar.gz" download="belfast-3.tar.gz">tarball </a> for this project contains the following files:</p>
<ul>
<li>trajectory-short.xyz : a (short) trajectory for a 16 residue protein in xyz format. All calculations with plumed driver use this trajectory.</li>
<li>trajectory-short.pdb : the same trajectory in pdb format, this can be loaded with VMD</li>
<li>template.pdb : a single frame from the trajectory that can be used in conjuction with the <a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a> command</li>
</ul>
<h1><a class="anchor" id="belfast-3-instructions"></a>
Instructions</h1>
<h2><a class="anchor" id="belfast-3-vis-traj"></a>
Visualising the trajectory</h2>
<p>The aim of this tutorial is to understand the data contained in the trajectory called trajectory-short.pdb. This file contains some frames from a simulation from a 16 residue protein. As a start point then let load this trajectory with vmd and have a look at it. Type the following command into the command line:</p>
<pre class="fragment">vmd trajectory-short.pdb
</pre><p>Look at it with the various representations that vmd offers. If you at are at the plumed tutorial try typing the letter m on the keyboard - we have made the new cartoon representation will update automatically for each frame of the trajectory - cool huh! What are your impressions about this trajectory based on looking at it with VMD? How many basins in the free energy landscape is this trajectory sampling from? What can we tell from looking at this trajectory that we could perhaps put in a paper?</p>
<p>If your answers to the questions at the end of the above paragraph are I don't know that is good. We can tell very little by just looking at a trajectory. In fact the whole point of today has been to find ways of analyzing trajectories precisely so that we are not put in this position of staring at trajetories mystified!</p>
<h2><a class="anchor" id="belfast-3-cvs"></a>
Finding collective variables</h2>
<p>Right so lets come up with some CVs to analyse this trajectory with. As some of you may know we can understand the conformation of proteins by looking at the Ramachandran angles. For those of you who don't know here is a Wikkepedia article:</p>
<p><a href="http://en.wikipedia.org/wiki/Ramachandran_plot">http://en.wikipedia.org/wiki/Ramachandran_plot</a></p>
<p>Our protein has 32 ramachandran angles. We'll come back to that. For the time being pick out a couple that you think might be useful and construct a plumed input to calculate them and print them to a file. You will need to use the <a class="el" href="_t_o_r_s_i_o_n.html">TORSION</a> and <a class="el" href="_p_r_i_n_t.html">PRINT</a> commands in order to do this. Once you have created your plumed input use driver to calculate the torsional angles using the following command:</p>
<pre class="fragment">plumed driver --plumed plumed.dat --ixyz trajectory.xyz
</pre><p>If you have done this correctly you should have an output file containing your torsional angles. We can use vmd+GISMO to visualise the relationship between the ramachandran angles and the atomic configurations. To do this first load the trajectory in VMD:</p>
<pre class="fragment">vmd trajectory-short.pdb
</pre><p>Then click on Extensions&gt;Analysis&gt;GISMO. A new window should open in this window click on File&gt;Load colvars. You will be asked to select a colvar file. Select the file that was output by the plumed calculation above. Once the file is loaded you should be able to select the labels that you gave to the Ramachandran angles you calculated with plumed. If you do so you will see that this data is plotted in the GISMO window so that you can interact with it and the trajectory.</p>
<p>What can you conclude from this exercise. Do the CV values of the various frames appear in clusters in the plane? Do points in different clusters correspond to structures that look the same or different? Are there similar looking structures clustered together or are they always far apart? What can we conclude about the various basins in the free energy landscape that have been explored in this trajectory? How many are there? Would your estimate be the same if you tried the above estimate with a different pair of ramachandran angles?</p>
<h2><a class="anchor" id="belfast-3-dim-red"></a>
Dimensionality reduction</h2>
<p>What we have done for most of today is seek out a function that takes as input the position of all the atoms in the system - a \(3N\) dimensional vector, where \(N\) is the number of atoms. This function then outputs a single number - the value of the collective variable - that tells us where in a low dimensional space we should project that configuration. Problems can arise because this collective-variable function is many-to-one. As you have hopefully seen in the previous exercise markedly different confifgurations of the protein can actually have quite similar values of a particular ramachandran angle.</p>
<p>We are going to spend the rest of this session introducing an alternative approach to this bussiness of finding collective variables. In this alternative approach we are going to stop trying to seek out a function that can take any configuration of the atoms (any \(3N\)-dimensional vector) and find it's low dimensional proejection on the collective variable axis. Instead we are going to take a set of configurations of the atoms (a set of \(3N\)-dimensional vectors of atom positions) and try to find a sensible set of projections for these configurations. We already touched on this idea earlier when we looked at paths. Our assumption, when we introduced this idea, was that we could find an ordered set of high-dimensional configurations that represented the transtion pathway the system takes as it crossed a barrier and changed between two particularly interesting configurations. Lets say we have a path defined by four reference configurations - this implies that to travel between the configurations at the start and the end of this path you have to pass through configuration 1, then configuration 2, then configuration 3 and then configuration 4. This ordering means that the numbers 1 through 4 constitute sensible projections of these high-dimensional configurations. The numbers 1 through 4 all lie on a single cartesian axis - a low-dimensional space.</p>
<p>The problem when it comes to applying this idea to the data that we have in the trajectory-short trajectory is that we have no information on the ``order" of these points. We have not been told that this trajectory represents the transition between two interesting points in phase space and thus we cannot apply the logic of paths. Hence, to seek out a low dimensional representation we are going to try and find a representation of this data we are going to seek out <a href="http://en.wikipedia.org/wiki/Isometry">an isometry </a> between the space containing the \(3N\)-dimensional vectors of atom positions and some lower-dimensional space. This idea is explained in more detail in the following <a href="https://www.youtube.com/watch?v=ofC2qz0_9_A&amp;feature=youtu.be">video </a>.</p>
<p>Let's now generate our isometric embedding. You will need to create a plumed input file that contains the following instructions:</p>
<pre class="fragment">CLASSICAL_MDS ...
  ATOMS=1-256
  METRIC=OPTIMAL-FAST
  USE_ALL_DATA
  NLOW_DIM=2
  OUTPUT_FILE=rmsd-embed
... CLASSICAL_MDS
</pre><p>You should then run this calculation using the following command:</p>
<pre class="fragment">plumed driver --ixyz trajectory-short.xyz --plumed plumed.dat
</pre><p>This should generate an output file called rmsd-embed. You should now be able to use VMD+GISMO to visualise this output. Do the CV values of the various frames appear in clusters in the plane? Do points in different clusters correspond to structures that look the same or different? Are there similar looking structures clustered together or are they always far apart? What can we conclude about the various basins in the free energy landscape that have been explored in this trajectory? How many are there? Do you think this gives you a fuller picture of the trajectory than the ones you obtained by considering ramachandran angles?</p>
<h1><a class="anchor" id="belfast-3-extensions"></a>
Extensions</h1>
<p>As discussed in the previous section this approach to trajectory analysis works by calcalating distances between pairs of atomic configurations. Projections corresponding to these configurations are then generated in the low dimensional space in a way that tries to preserve these pairwise distances. There are, however, an infinite number of ways of calculating the distance between two high-dimensional configurations. In the previous section we used the RMSD distance but you could equally use the DRMSD distance. You could even try calculating a large number of collective variables for each of the high-dimensional points and seeing how much these all changed. You can use these different types of distances with the <a class="el" href="_c_l_a_s_s_i_c_a_l__m_d_s.html">CLASSICAL_MDS</a> action that was introduced in the previous section. If you have time less at the end of the session read the manual for the <a class="el" href="_c_l_a_s_s_i_c_a_l__m_d_s.html">CLASSICAL_MDS</a> action and see if you can calculate an MDS projection using an alternative defintion of the distances between configurations. Some suggestions to try in order of increasing difficulty: DRMSD, how much the full set of 32 ramachandran angles change and the change in the contact map</p>
<h1><a class="anchor" id="belfast-3-further"></a>
Further Reading</h1>
<p>There is a growing community of people using these ideas to analyse trajectory data. Some start points for investigating their work in more detail are:</p>
<ul>
<li><a href="http://sketchmap.berlios.de">http://sketchmap.berlios.de</a></li>
<li><a href="http://www.annualreviews.org/doi/abs/10.1146/annurev-physchem-040412-110006">http://www.annualreviews.org/doi/abs/10.1146/annurev-physchem-040412-110006</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
