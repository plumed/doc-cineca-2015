<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PLUMED: Belfast tutorial: Steinhardt Parameters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed-code.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.3.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;(cineca-2015)</span></a></li>
      <li><a href="_syntax.html"><span>Getting&#160;started</span></a></li>
      <li><a href="tutorials.html"><span>Tutorials</span></a></li>
      <li><a href="glossary.html"><span>Index&#160;of&#160;Actions</span></a></li>
      <li><a href="cineca.html"><span>Cineca</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('belfast-10.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Belfast tutorial: Steinhardt Parameters </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="belfast-10-aim"></a>
Aims</h1>
<p>This tutorial is concerned with the collective variables that we use to study order/disorder transitions such as the transition between the solid and liquid phase. In this tutorial we will look at the transition from solid to liquid as this is easier to study using simulation. The CVs we will intorduce can, and have, been used to study the transition from liquid to solid. More information can be found in the further reading section.</p>
<h2><a class="anchor" id="belfast-10-lo"></a>
Learning Outcomes</h2>
<p>Once this tutorial is completed students will:</p>
<ul>
<li>Know of the existence of the Steinhardt Parameters and know how to create plumed input files for calculating them.</li>
<li>Appreciate that the Steinhardt Parameter for a particular atom is a vector quantity and that you can thus measure local order in a material by taking dot products of the Steinhardt Parameter vectors of adjacent atoms. Students will know how to calculate such quantities using plumed.</li>
</ul>
<h1><a class="anchor" id="belfast-10-res"></a>
Resources</h1>
<p>The <a href="tutorial-resources/belfast-9b.tar.gz" download="belfast-9b.tar.gz">tarball </a> for this project contains the following files:</p>
<ul>
<li>in : An input file for the simplemd code that forms part of plumed</li>
<li>input.xyz : A configuration file for Lennard-Jones solid with an fcc solid structure</li>
</ul>
<h1><a class="anchor" id="belfast-10-ins"></a>
Instructions</h1>
<h2><a class="anchor" id="belfast-10-simplemd"></a>
Simplemd</h2>
<p>For this tutorial we will be using the MD code that is part of plumed - simplemd. This code allows us to do the simulations of <a href="http://en.wikipedia.org/wiki/Lennard-Jones_potential">Lennard-Jones </a> that we require here but not much else. We will thus start this tutorial by doing some simulations with this code. You should have two files from the tarball, the first is called input.xyz and is basically an xyz file containing the posisitions of the atoms. The second meanwhile is called in and is the input to simplemd. If you open the file the contents should look something like this:</p>
<pre class="fragment">inputfile input.xyz
outputfile output.xyz
temperature 0.2
tstep 0.005
friction 1
forcecutoff 2.5
listcutoff  3.0
nstep 50000
nconfig 100 trajectory.xyz
nstat   10 energies.dat
</pre><p>Having run some molecular dynamics simulations in the past it should be pretty obvious what each line of the file does. One thing that might be a little strange is the units. Simplemd works with Lennard-Jones units so energy is in units of \(\epsilon\) and length is in units of \(\sigma\). This means that temperature is in units of \(\frac{k_B T}{\epsilon}\), which is why the temperature in the above file is apparently so low.</p>
<p>Use simplemd to run 50000 step calculations at 0.2, 0.8 and 1.2 \(\frac{k_B T}{\epsilon}\). (N.B. You will need an empty file called plumed.dat in order to run these calculations.) Visualise the trajectory output by each of your simulations using VMD. Please be aware that simplemd does not wrap the atoms into the cell box automatically. If you are at the tutorial we have resolved this problem by making it so that if you press w when you load all the atoms they will be wrapped into the box. At what temperatures did the simulations melt? What then is the melting point of the Lennard-Jones potential at this density?</p>
<h2><a class="anchor" id="belfast-10-cvs"></a>
Coordination Numbers</h2>
<p>At the end of the previous section you were able to make very sophisticated judegements about whether or not the arrangment of atoms in your system was solid-like or liquid-like by simply looking at the configuration. The aim in the rest of this tutorial is to see if we can derive collective variables that are able to make an equally sophisticated judgement. For our first attempt lets use a CV which we have encoutered elsewhere, the <a class="el" href="_c_o_o_r_d_i_n_a_t_i_o_n_n_u_m_b_e_r.html">COORDINATIONNUMBER</a>.</p>
<p>Create a plumed input file that calculates the average <a class="el" href="_c_o_o_r_d_i_n_a_t_i_o_n_n_u_m_b_e_r.html">COORDINATIONNUMBER</a> of the atoms in your system and outputs it to a file every 100 steps. You will need to use the <a class="el" href="_c_o_o_r_d_i_n_a_t_i_o_n_n_u_m_b_e_r.html">COORDINATIONNUMBER</a> and <a class="el" href="_p_r_i_n_t.html">PRINT</a> actions. The switching function that tells plumed whether or not two atoms are bonded should be of type RATIONAL and should have its \(d_0\) parameter equal to 1.3 its \(r_0\) parameter equal to 0.2 and its \(n\) and \(m\) parameters set equal to 6 and 12 repsectively.</p>
<p>Rerun the simpled simulations described at the end of the previous section. Is the average coordination number good at differentiaing between solid and liquid configurations? Given your knowledge of physics/chemistry is this result surprising?</p>
<h2><a class="anchor" id="belfast-10-steinhardt"></a>
Steinhard parameter</h2>
<p>The solid and liquid phases of a material are both relatively dense so the result at the end of the last section - the fact that the coordination number is not particularly good at differentiating between them - should not be that much of a surprise. As you will have learnt early on in your scientific education when solids melt the atoms rearrange themselves in a much less ordered fashion. The bonds between them do not necessarily break it is just that, whereas in a the solid the bonds were all at pretty well defined angles to each other, in a liquid the spread of bond angles is considerably larger. To detect the transition from solid to liquid what we need then is a coordinate that is able to recognise whether or not the geometry in the coordination spheres around each of the atoms in the system are the same or different. If these geometries are the same the system is in a solid-like configuration, whereas if they are different the system is liquid-like. The Steinhardt parameters <a class="el" href="_q3.html">Q3</a>, <a class="el" href="_q4.html">Q4</a> and <a class="el" href="_q6.html">Q6</a> are coordinates that allow us to examine the coordination spheres of atoms in precisely this way. The way in which these coordinates are able to do this is explained in the <a href="https://www.youtube.com/watch?v=ou0uKgK35lE">video </a>.</p>
<p>Repeat the calculations from the end of the previous section but edit the plumed.dat file so that the average <a class="el" href="_q6.html">Q6</a> parameter is calculated and printed as well as the average <a class="el" href="_c_o_o_r_d_i_n_a_t_i_o_n_n_u_m_b_e_r.html">COORDINATIONNUMBER</a>. In the Steinhardt parameter implementation in plumed the set of atoms in the coordination sphere of a particular atom are defined using a continuous switching function. For this calculation you should use a RATIONAL switching funciton with parameters \(d_0\) equal to 1.3, \(r_0\) equal to 0.2 and \(n\) and \(m\) set equal to 6 and 12 repsectively. Is the average Q6 parameter able to differentiate between the solid and liquid states?</p>
<h2><a class="anchor" id="belfast-10-lvsg"></a>
Local versus Global</h2>
<p>At the end of the previous section you showed that the average Q6 parameter for a system of atoms is able to tell you whether or not that collection of atoms is in a solid-like or liquid-like configuration. In this section we will now ask the question - can the Steinhardt parameter always, unambiously tell us whether particular tagged atoms are in a solid-like region of the material or whether they are in a liquid-like region of the material? This is an important question that might come up if we are looking at nucleation of a solid from the melt. Our question in this context reads - how do we unambigously identify those atoms that are in the crystalline nucleus? A similar question would also come up when studying an interface between the solid and liquid phases. In this guise we would be asking about the extent of interface; namely, how far from the interface do we have to go before we can start thinking of the atoms as just another atom in the solid/liquid phase?</p>
<p>With these questions in mind our aim is to look at the distribution of values for the Q6 parameters of atoms in our system of Lennard-Jones have. If Q6 is able to unambigously tell us whether or not an atom is in a solid-like pose or a liquid-like pose then there should be no overlap in the distributions obtained for the solid and liquid phases. If there is overlap, however, then we cannot use these coordinates for the applications described in the previous paragraph. To calculate these distributions you will need to run two simulations - one at 0.2 \(\frac{k_B T}{\epsilon}\) and one at 1.2 \(\frac{k_Bt}{\epsilon}\). For these simulation you will need plumed.dat files that calculate and output the distribution of Steinhardt parameters. In writing the plumed input for these calcualtions you will need to use the <a class="el" href="_p_r_i_n_t.html">PRINT</a> command and the <a class="el" href="_q6.html">Q6</a> command. In your Q6 instructions you will need to use the HISTOGRAM keyword - my recommendation would be to calculate a histogram consisting of 20 bins over a range starting at 0.0 and finishing at 1.0. Set the SMEAR parameter equal to 0.1. Do the distributions of Q6 parameters for the solid and liquid phase overlap? N.B. You can load the output from these simulations using GISMO and the all cvs button from the bar at the bottom.</p>
<h2><a class="anchor" id="belfast-10-links"></a>
Local Steinhardt parameters</h2>
<p>Hopefully you saw that the distribution of Q6 parameters for the solid and liquid phase overlap at the end of the previous section. Again this is not so surprising - as you go from solid to liquid the distribution of the geometries of the coordination spheres widens. The system is now able to arrange the atoms in the coordination spheres in a much wider variety of different poses. Importantly, however, the fact that an atom is in a liquid does not preclude it from having a very-ordered, solid-like coordination environment. As such in the liquid state we will find the occasional atom with a high value for the Q6 parameter. Consequently, an ordred coordination environment does not always differentiate solid-like atoms from liquid-like atoms. The major difference is the liquid the ordered atoms will always be isolated. That is to say in the liquid atoms with an ordered coordination will always be surrounded by atoms with a disordered coordination sphere. By contrast in the solid each ordered atom will be surrounded by further ordered atoms. This observation forms the basis of the local Steinhardt parameters and the locally averaged Steinhardt parameters that are explained in this <a href="https://www.youtube.com/watch?v=JBtIs5qYIPE&amp;feature=youtu.be">video </a>.</p>
<p>Lets use plumed to calculate the distribution of <a class="el" href="_l_o_c_a_l__q6.html">LOCAL_Q6</a> parameters in the solid and liquid phases. Repeat the calculations from the previous section but now use the HISTOGRAM keyword to calculate the distribution of <a class="el" href="_l_o_c_a_l__q6.html">LOCAL_Q6</a> parameters. For the switching function in the <a class="el" href="_l_o_c_a_l__q6.html">LOCAL_Q6</a> parameter instruction use a RATIONAL function with \(d_0\) equal to 1.3, \(r_0\) equal to 0.2 and \(n\) and \(m\) set equal to 6 and 12 repsectively. For the HISTOGRAM use 20 bins starting at 0.0 and finishing at 1.0. Se the SMEAR paraemter equal to 0.1. Do the distributions of <a class="el" href="_l_o_c_a_l__q6.html">LOCAL_Q6</a> parameter for the solid and liquid phases overlap?</p>
<p>Lectner and Dellago have designed an alternative to the <a class="el" href="_l_o_c_a_l__q6.html">LOCAL_Q6</a> parameter that is based on taking the <a class="el" href="_l_o_c_a_l__a_v_e_r_a_g_e.html">LOCAL_AVERAGE</a> of the Q6 parameter arround a central atom. This quantity can be calcualted using plumed. If you have time try to use the manual to work out how.</p>
<h1><a class="anchor" id="belfast-10-further"></a>
Further Reading</h1>
<p>There is a substantial literature on simulation of nucleation. Some papers are listed below but this list is far from exhaustive.</p>
<ul>
<li>F. Trudu, D. Donadio and M. Parrinello <a href="http://journals.aps.org/prl/abstract/10.1103/PhysRevLett.97.105701">Freezing of a Lennard-Jones Fluid: From Nucleation to Spinodal Regime </a>, Phys. Rev. Lett. 97 105701 (2006)</li>
<li>D. Quigley and P. M. Rodger <a href="http://dx.doi.org/10.1080/08927020802647280">A metadynamics-based approach to sampling crystallization events </a>, Mol. Simul. 2009</li>
<li>W. Lechner and C. Dellago <a href="http://scitation.aip.org/content/aip/journal/jcp/129/11/10.1063/1.2977970">Accurate determination of crystal structures based on averaged local bond order parameters </a> J. Chem. Phys 129 114707 (2008) </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
