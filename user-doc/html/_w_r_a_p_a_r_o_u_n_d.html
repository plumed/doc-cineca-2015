<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PLUMED: WRAPAROUND</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed-code.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.3.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;(cineca-2015)</span></a></li>
      <li><a href="_syntax.html"><span>Getting&#160;started</span></a></li>
      <li><a href="tutorials.html"><span>Tutorials</span></a></li>
      <li><a href="glossary.html"><span>Index&#160;of&#160;Actions</span></a></li>
      <li><a href="cineca.html"><span>Cineca</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_w_r_a_p_a_r_o_u_n_d.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">WRAPAROUND </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table  align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the generic <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Rebuild periodic boundary conditions around chosen atoms.</p>
<p>Modify position of atoms indicated by ATOMS by shifting them by lattice vectors so that they are as close as possible to the atoms indicated by AROUND. More precisely, for every atom i in the ATOMS list the following procedure is performed:</p><ul>
<li>The atom j among those in the AROUND list is searched that is closest to atom i.</li>
<li>The atom i is replaced with its periodic image that is closest to atom j.</li>
</ul>
<p>This action works similarly to <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> in that it replaces atoms coordinate. Notice that only atoms specified with ATOMS are replaced, and that, at variance with <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a>, the order in which atoms are specified is irrelevant.</p>
<p>This is often convenient at a post processing stage (using the <a class="el" href="driver.html">driver</a>), but sometime it is required during the simulation if collective variables need atoms to be in a specific periodic image.</p>
<dl class="section attention"><dt>Attention</dt><dd>This directive modifies the stored position at the precise moment it is executed. This means that only collective variables which are below it in the input script will see the corrected positions. As a general rule, put it at the top of the input file. Also, unless you know exactly what you are doing, leave the default stride (1), so that this action is performed at every MD step.</dd></dl>
<p>Consider that the computational cost grows with the product of the size of the two lists (ATOMS and AROUND), so that this action can become very expensive. If you are using it to analyse a trajectory this is usually not a big problem. If you use it to analyze a simulation on the fly, e.g. with <a class="el" href="_d_u_m_p_a_t_o_m_s.html">DUMPATOMS</a> to store a properly wrapped trajectory, consider the possibility of using the STRIDE keyword here (with great care). </p><dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> AROUND </b> </td><td>reference atoms. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
<tr>
<td width="15%"><b> ATOMS </b> </td><td>wrapped atoms. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> STRIDE </b> </td><td>( default=1 ) the frequency with which molecules are reassembled. Unless you are completely certain about what you are doing leave this set equal to 1!   </td></tr>
<tr>
<td width="15%"><b> GROUPBY </b> </td><td>( default=1 ) group atoms so as not to break molecules   </td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>This command instructs plumed to move all the ions to their periodic image that is as close as possible to the rna group.</p>
<pre class="fragment">rna: GROUP ATOMS=1-100
ions: GROUP ATOMS=101-110
# first make the rna molecule whole
WHOLEMOLECULES ENTITY0=rna
WRAPAROUND ATOMS=ions AROUND=rna
DUMPATOMS FILE=dump.xyz ATOMS=rna,ions
</pre><p> (see also <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a>, <a class="el" href="_g_r_o_u_p.html">GROUP</a> and <a class="el" href="_d_u_m_p_a_t_o_m_s.html">DUMPATOMS</a>)</p>
<p>In case you want to do it during a simulation and you only care about wrapping the ions in the <code>dump.xyz</code> file, you can use the following:</p>
<pre class="fragment"># add some restraint that do not require molecules to be whole:
a: TORSION ATOMS=1,2,10,11
RESTRAINT ARG=a AT=0.0 KAPPA=5


# then do the things that are required for dumping the trajectory
# notice that they are all done every 100 steps, so as not to 
# unnecessarily overload the calculation

rna: GROUP ATOMS=1-100
ions: GROUP ATOMS=101-110
# first make the rna molecule whole
WHOLEMOLECULES ENTITY0=rna STRIDE=100
WRAPAROUND ATOMS=ions AROUND=rna STRIDE=100
DUMPATOMS FILE=dump.xyz ATOMS=rna,ions STRIDE=100
</pre><p> (see also <a class="el" href="_t_o_r_s_i_o_n.html">TORSION</a>, <a class="el" href="_g_r_o_u_p.html">GROUP</a>, <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> and <a class="el" href="_d_u_m_p_a_t_o_m_s.html">DUMPATOMS</a>)</p>
<p>Notice that if the biased variable requires a molecule to be whole, you might have to put just the <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> command before computing that variable and leave the default STRIDE=1.</p>
<p>This command instructs plumed to center all atoms around the center of mass of a solute molecule.</p>
<pre class="fragment">solute: GROUP ATOMS=1-100
all: GROUP ATOMS=1-1000
# center of the solute:
# notice that since plumed 2.2 this also works if the
# solute molecule is broken
com: COM ATOMS=solute
# notice that we wrap around a single atom. this should be fast
WRAPAROUND ATOMS=all AROUND=com
DUMPATOMS FILE=dump.xyz ATOMS=all
</pre><p> (see also <a class="el" href="_g_r_o_u_p.html">GROUP</a> <a class="el" href="_c_o_m.html">COM</a> <a class="el" href="_d_u_m_p_a_t_o_m_s.html">DUMPATOMS</a>)</p>
<p>Notice that whereas <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> is designed to make molecules whole, <a class="el" href="_w_r_a_p_a_r_o_u_n_d.html">WRAPAROUND</a> can easily break molecules. In the last example, if solvent (atoms 101-1000) is made e.g. of water, then water molecules could be broken by <a class="el" href="_w_r_a_p_a_r_o_u_n_d.html">WRAPAROUND</a> (hydrogen could end up in an image and oxygen in another one). One solution is to use <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> on <em>all</em> the water molecules after <a class="el" href="_w_r_a_p_a_r_o_u_n_d.html">WRAPAROUND</a>. This is tedious. A better solution is to use the GROUPBY option which is going to consider the atoms listed in ATOMS as a list of groups each of size GROUPBY. The first atom of the group will be brought close to the AROUND atoms. The following atoms of the group will be just brought close to the first atom of the group. Assuming that oxygen is the first atom of each water molecules, in the following examples all the water oxygens will be brought close to the solute, and all the hydrogens will be kept close to their related oxygen.</p>
<pre class="fragment">solute: GROUP ATOMS=1-100
water: GROUP ATOMS=101-1000
com: COM ATOMS=solute
# notice that we wrap around a single atom. this should be fast
WRAPAROUND ATOMS=solute AROUND=com
# notice that we wrap around a single atom. this should be fast
WRAPAROUND ATOMS=water AROUND=com GROUPBY=3
DUMPATOMS FILE=dump.xyz ATOMS=solute,water
</pre><p> (see also <a class="el" href="_g_r_o_u_p.html">GROUP</a> <a class="el" href="_c_o_m.html">COM</a> <a class="el" href="_d_u_m_p_a_t_o_m_s.html">DUMPATOMS</a>) </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective variables</a></li><li class="navelem"><a class="el" href="_group.html">Groups and Virtual Atoms</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
