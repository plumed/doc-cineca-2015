<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PLUMED: CAVITY</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed-code.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.3.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;(cineca-2015)</span></a></li>
      <li><a href="_syntax.html"><span>Getting&#160;started</span></a></li>
      <li><a href="tutorials.html"><span>Tutorials</span></a></li>
      <li><a href="glossary.html"><span>Index&#160;of&#160;Actions</span></a></li>
      <li><a href="cineca.html"><span>Cineca</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_c_a_v_i_t_y.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CAVITY </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table  align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the multicolvar <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>This quantity can be used to calculate functions of the distribution of collective variables for the atoms that lie in a box defined by the positions of four atoms.</p>
<p>Each of the base quantities calculated by a multicolvar can can be assigned to a particular point in three dimensional space. For example, if we have the coordination numbers for all the atoms in the system each coordination number can be assumed to lie on the position of the central atom. Because each base quantity can be assigned to a particular point in space we can calculate functions of the distribution of base quantities in a particular part of the box by using:</p>
<p class="formulaDsp">
\[ \overline{s}_{\tau} = \frac{ \sum_i f(s_i) w(u_i,v_i,w_i) }{ \sum_i w(u_i,v_i,w_i) } \]
</p>
<p>where the sum is over the collective variables, \(s_i\), each of which can be thought to be at \( (u_i,v_i,z_i)\). Notice that here (at variance with what is done in <a class="el" href="_a_r_o_u_n_d.html">AROUND</a>) we have transformed from the usual \((x_i,y_i,z_i)\) position to a position in \( (u_i,v_i,z_i)\). This is done using a rotation matrix as follows:</p>
<p class="formulaDsp">
\[ \left( \begin{matrix} u_i \\ v_i \\ w_i \end{matrix} \right) = \mathbf{R} \left( \begin{matrix} x_i - x_o \\ y_i - y_o \\ z_i - z_o \end{matrix} \right) \]
</p>
<p>where \(\mathbf{R}\) is a rotation matrix that is calculated by constructing a set of three orthonormal vectors from the refererence positions specified by the user. The first of these unit vectors points from the first reference atom to the second. The second is then the normal to the plane containing atoms 1,2 and 3 and the the third is the unit vector orthogonal to these first two vectors. \((x_o,y_o,z_o)\), meanwhile, specifies the position of the first reference atom.</p>
<p>In the previous function \( w(u_i,v_i,w_i) \) measures whether or not the system is in the subregion of interest. It is equal to:</p>
<p class="formulaDsp">
\[ w(u_i,v_i,w_i) = \int_{0}^{u&#39;} \int_{0}^{v&#39;} \int_{0}^{w&#39;} \textrm{d}u\textrm{d}v\textrm{d}w K\left( \frac{u - u_i}{\sigma} \right)K\left( \frac{v - v_i}{\sigma} \right)K\left( \frac{w - w_i}{\sigma} \right) \]
</p>
<p>where \(K\) is one of the kernel functions described on <a class="el" href="histogrambead.html">histogrambead</a> and \(\sigma\) is a bandwidth parameter. The function \((s_i)\) can be any of the usual LESS_THAN, MORE_THAN, WITHIN etc that are used in all other multicolvars. The vector connecting atom 1 to atom 4 is used to define the extent of the box in each of the \(u\), \(v\) and \(w\) directions. Essentially the vector connecting atom 1 to atom 4 is projected onto the three unit vectors described above and the resulting projections determine the \(u&#39;\), \(v&#39;\) and \(w&#39;\) parameters in the above expression.</p>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>When the label of this action is used as the input for a second you are not referring to a scalar quantity as you are in regular collective variables. The label is used to reference the full set of quantities calculated by the action. This is usual when using <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a>. Generally when doing this the previously calculated multicolvar will be referenced using the DATA keyword rather than ARG.</p>
<p>This Action can be used to calculate the following scalar quantities directly. These quantities are calculated by employing the keywords listed below. These quantities can then be referenced elsewhere in the input file by using this Action's label followed by a dot and the name of the quantity. Some amongst them can be calculated multiple times with different parameters. In this case the quantities calculated can be referenced elsewhere in the input by using the name of the quantity followed by a numerical identifier e.g. <em>label</em>.lessthan-1, <em>label</em>.lessthan-2 etc. When doing this and, for clarity we have made the label of the components customizable. As such by using the LABEL keyword in the description of the keyword input you can customize the component name</p>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> vmean </b> </td><td width="10%"><b> VMEAN </b>  </td><td>the norm of the mean vector. The output component can be refererred to elsewhere in the input file by using the label.vmean   </td></tr>
<tr>
<td width="5%"><b> between </b> </td><td width="10%"><b> BETWEEN </b>  </td><td>the number/fraction of values within a certain range. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
<tr>
<td width="5%"><b> lessthan </b> </td><td width="10%"><b> LESS_THAN </b>  </td><td>the number of values less than a target value. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
<tr>
<td width="5%"><b> mean </b> </td><td width="10%"><b> MEAN </b>  </td><td>the mean value. The output component can be refererred to elsewhere in the input file by using the label.mean   </td></tr>
<tr>
<td width="5%"><b> morethan </b> </td><td width="10%"><b> MORE_THAN </b>  </td><td>the number of values more than a target value. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
</table>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ATOMS </b> </td><td>the positions of four atoms that define spatial extent of the cavity. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> DATA </b> </td><td>The multicolvar that calculates the set of base quantities that we are interested in   </td></tr>
<tr>
<td width="15%"><b> SIGMA </b> </td><td>the width of the function to be used for kernel density estimation   </td></tr>
<tr>
<td width="15%"><b> KERNEL </b> </td><td>( default=gaussian ) the type of kernel function to be used   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) do the calculation in serial. Do not parallelize   </td></tr>
<tr>
<td width="15%"><b> LOWMEM </b> </td><td>( default=off ) lower the memory requirements   </td></tr>
<tr>
<td width="15%"><b> TIMINGS </b> </td><td>( default=off ) output information on the timings of the various parts of the calculation   </td></tr>
<tr>
<td width="15%"><b> OUTSIDE </b> </td><td>( default=off ) calculate quantities for colvars that are on atoms outside the region of interest   </td></tr>
<tr>
<td width="15%"><b> PRINT_BOX </b> </td><td><p class="starttd">( default=off ) write out the positions of the corners of the box to an xyz file  </p>
<p class="endtd"></p>
</td></tr>
</table>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> VMEAN </b> </td><td>calculate the norm of the mean vector. The final value can be referenced using <em>label</em>.vmean. You can use multiple instances of this keyword i.e. VMEAN1, VMEAN2, VMEAN3... The corresponding values are then referenced using <em>label</em>.vmean-1, <em>label</em>.vmean-2, <em>label</em>.vmean-3...   </td></tr>
<tr>
<td width="15%"><b> MEAN </b> </td><td>take the mean of these variables. The final value can be referenced using <em>label</em>.mean. You can use multiple instances of this keyword i.e. MEAN1, MEAN2, MEAN3... The corresponding values are then referenced using <em>label</em>.mean-1, <em>label</em>.mean-2, <em>label</em>.mean-3...   </td></tr>
<tr>
<td width="15%"><b> LESS_THAN </b> </td><td>calculate the number of variables less than a certain target value. This quantity is calculated using \(\sum_i \sigma(s_i)\), where \(\sigma(s)\) is a <a class="el" href="switchingfunction.html">switchingfunction</a>. The final value can be referenced using <em>label</em>.lessthan. You can use multiple instances of this keyword i.e. LESS_THAN1, LESS_THAN2, LESS_THAN3... The corresponding values are then referenced using <em>label</em>.lessthan-1, <em>label</em>.lessthan-2, <em>label</em>.lessthan-3...   </td></tr>
<tr>
<td width="15%"><b> MORE_THAN </b> </td><td>calculate the number of variables more than a certain target value. This quantity is calculated using \(\sum_i 1.0 - \sigma(s_i)\), where \(\sigma(s)\) is a <a class="el" href="switchingfunction.html">switchingfunction</a>. The final value can be referenced using <em>label</em>.morethan. You can use multiple instances of this keyword i.e. MORE_THAN1, MORE_THAN2, MORE_THAN3... The corresponding values are then referenced using <em>label</em>.morethan-1, <em>label</em>.morethan-2, <em>label</em>.morethan-3...   </td></tr>
<tr>
<td width="15%"><b> BETWEEN </b> </td><td>calculate the number of values that are within a certain range. These quantities are calculated using kernel density estimation as described on <a class="el" href="histogrambead.html">histogrambead</a>. The final value can be referenced using <em>label</em>.between. You can use multiple instances of this keyword i.e. BETWEEN1, BETWEEN2, BETWEEN3... The corresponding values are then referenced using <em>label</em>.between-1, <em>label</em>.between-2, <em>label</em>.between-3...   </td></tr>
<tr>
<td width="15%"><b> HISTOGRAM </b> </td><td>calculate a discretized histogram of the distribution of values. This shortcut allows you to calculates NBIN quantites like BETWEEN. The final value can be referenced using <em>label</em>.histogram. You can use multiple instances of this keyword i.e. HISTOGRAM1, HISTOGRAM2, HISTOGRAM3... The corresponding values are then referenced using <em>label</em>.histogram-1, <em>label</em>.histogram-2, <em>label</em>.histogram-3...   </td></tr>
<tr>
<td width="15%"><b> FILE </b> </td><td>the file on which to write out the box coordinates   </td></tr>
<tr>
<td width="15%"><b> UNITS </b> </td><td><p class="starttd">( default=nm ) the units in which to write out the corners of the box  </p>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following commands tell plumed to calculate the number of atoms in an ion chanel in a protein. The extent of the chanel is calculated from the positions of atoms 1, 4, 5 and 11. The final value will be labeled cav.</p>
<pre class="fragment">d1: DENSITY SPECIES=20-500 
CAVITY DATA=d1 ATOMS=1,4,5,11 SIGMA=0.1 LABEL=cav
</pre><p>The following command tells plumed to calculate the coordination numbers (with other water molecules) for the water molecules in the protein channel described above. The average coordination number and the number of coordination numbers more than 4 is then calculated. The values of these two quantities are given the labels cav.mean and cav.more-than</p>
<pre class="fragment">d1: COORDINATIONNUMBER SPECIES=20-500
CAVITY DATA=d1 ATOMS=1,4,5,11 SIGMA=0.1 MEAN MORE_THAN={RATIONAL R_0=4} LABEL=cav
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective variables</a></li><li class="navelem"><a class="el" href="mcolv.html">MultiColvar</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
