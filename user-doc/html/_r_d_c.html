<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PLUMED: RDC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed-code.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.3.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;(cineca-2015)</span></a></li>
      <li><a href="_syntax.html"><span>Getting&#160;started</span></a></li>
      <li><a href="tutorials.html"><span>Tutorials</span></a></li>
      <li><a href="glossary.html"><span>Index&#160;of&#160;Actions</span></a></li>
      <li><a href="cineca.html"><span>Cineca</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_r_d_c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">RDC </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table  align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the colvar <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Calculates the Residual Dipolar Coupling between two atoms.</p>
<p>The RDC between two atomic nuclei depends on the \(\theta\) angle between the inter-nuclear vector and the external magnetic field. In isotropic media RDCs average to zero because of the orientational averaging, but when the rotational symmetry is broken, either through the introduction of an alignment medium or for molecules with highly anisotropic paramagnetic susceptibility, RDCs become measurable.</p>
<p class="formulaDsp">
\[ D=D_{max}0.5(3\cos^2(\theta)-1) \]
</p>
<p>where</p>
<p class="formulaDsp">
\[ D_{max}=-\mu_0\gamma_1\gamma_2h/(8\pi^3r^3) \]
</p>
<p>that is the maximal value of the dipolar coupling for the two nuclear spins with gyromagnetic ratio \(\gamma\). \(\mu\) is the magnetic constant and h is the Planck constant.</p>
<p>Common Gyromagnetic Ratios (C.G.S)</p><ul>
<li>H(1) 26.7513</li>
<li>C(13) 6.7261</li>
<li>N(15) -2.7116</li>
<li>NH -72.5388</li>
<li>CH 179.9319</li>
<li>CN -18.2385</li>
<li>CC 45.2404</li>
</ul>
<p>This collective variable calculates the Residual Dipolar Coupling for a set of couple of atoms using the above definition. From the calculated RDCs and a set of experimental values it calculates either their correlation or the squared quality factor</p>
<p class="formulaDsp">
\[ Q^2=\frac{\sum_i(D_i-D^{exp}_i)^2}{\sum_i(D^{exp}_i)^2} \]
</p>
<p>RDCs report only on the fraction of molecules that is aligned, this means that comparing the RDCs from a single structure in a MD simulation to the experimental values is not particularly meaningfull, from this point of view it is better to compare their correlation. The fraction of aligned molecules can be obtained by maximising the correlation between the calculated and the experimental RDCs. This fraction can be used as a scaling factor in the calculation of the RDCs in order to compare their values. The averaging of the RDCs calculated with the above definition from a standard MD should result to 0 because of the rotational diffusion, but this variable can be used to break the rotational symmetry.</p>
<p>RDCs can also be calculated using a Single Value Decomposition approach, in this case the code rely on the a set of function from the GNU Scientific Library (GSL). (With SVD forces are not currently implemented).</p>
<p>Replica-Averaged restrained simulations can be performed with this CV using the ENSEMBLE flag.</p>
<p>Additional material and examples can be also found in the tutorial <a class="el" href="belfast-9.html">Belfast tutorial: NMR constraints</a></p>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ATOMS </b> </td><td>the couple of atoms involved in each of the bonds for which you wish to calculate the RDC. Keywords like ATOMS1, ATOMS2, ATOMS3,... should be listed and one dipolar coupling will be calculated for each ATOMS keyword you specify. You can use multiple instances of this keyword i.e. ATOMS1, ATOMS2, ATOMS3...   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> WRITE_DC </b> </td><td>( default=0 ) Write the back-calculated dipolar couplings every # steps.   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> ENSEMBLE </b> </td><td>( default=off ) Set to TRUE if you want to average over multiple replicas.   </td></tr>
<tr>
<td width="15%"><b> CORRELATION </b> </td><td>( default=off ) Set to TRUE if you want to kept constant the bonds distances.   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) Set to TRUE if you want to run the CV in serial.   </td></tr>
<tr>
<td width="15%"><b> SVD </b> </td><td><p class="starttd">( default=off ) Set to TRUE if you want to backcalculate using Single Value Decomposition (need GSL at compilation time).  </p>
<p class="endtd"></p>
</td></tr>
</table>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> COUPLING </b> </td><td>Add an experimental value for each coupling. You can use multiple instances of this keyword i.e. COUPLING1, COUPLING2, COUPLING3...   </td></tr>
<tr>
<td width="15%"><b> GYROM </b> </td><td>Add the product of the gyromagnetic constants for each bond. You can use multiple instances of this keyword i.e. GYROM1, GYROM2, GYROM3...   </td></tr>
<tr>
<td width="15%"><b> SCALE </b> </td><td>Add a scaling factor to take into account concentration and other effects. You can use multiple instances of this keyword i.e. SCALE1, SCALE2, SCALE3...   </td></tr>
<tr>
<td width="15%"><b> BONDLENGTH </b> </td><td><p class="starttd">Set a fixed length for for the bonds distances. You can use multiple instances of this keyword i.e. BONDLENGTH1, BONDLENGTH2, BONDLENGTH3...  </p>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd>In the following example five N-H RDCs are defined and their correlation with respect to a set of experimental data is calculated.</dd></dl>
<pre class="fragment">RDC ...
GYROM=-72.5388
SCALE=1.0 
CORRELATION
ATOMS1=20,21 COUPLING1=8.17
ATOMS2=37,38 COUPLING2=-8.271
ATOMS3=56,57 COUPLING3=-10.489
ATOMS4=76,77 COUPLING4=-9.871
ATOMS5=92,93 COUPLING5=-9.152
LABEL=nh
... RDC 

rdce: RESTRAINT ARG=nh KAPPA=0. SLOPE=-25000.0 AT=1.

PRINT ARG=nh,rdce.bias FILE=colvar
</pre><p> (See also <a class="el" href="_p_r_i_n_t.html">PRINT</a>, <a class="el" href="_r_e_s_t_r_a_i_n_t.html">RESTRAINT</a>) </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective variables</a></li><li class="navelem"><a class="el" href="_colvar.html">CV Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
