<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PLUMED: Q4</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed-code.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.3.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;(cineca-2015)</span></a></li>
      <li><a href="_syntax.html"><span>Getting&#160;started</span></a></li>
      <li><a href="tutorials.html"><span>Tutorials</span></a></li>
      <li><a href="glossary.html"><span>Index&#160;of&#160;Actions</span></a></li>
      <li><a href="cineca.html"><span>Cineca</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_q4.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Q4 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table  align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the crystallization <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=crystallization . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Calculate 4th order Steinhardt parameters.</p>
<p>The 4th order Steinhardt parameters allow us to measure the degree to which the first coordination shell around an atom is ordered. The Steinhardt parameter for atom, \(i\) is complex vector whose components are calculated using the following formula:</p>
<p class="formulaDsp">
\[ q_{4m}(i) = \frac{\sum_j \sigma( r_{ij} ) Y_{4m}(\mathbf{r}_{ij}) }{\sum_j \sigma( r_{ij} ) } \]
</p>
<p>where \(Y_{4m}\) is one of the 4th order spherical harmonics so \(m\) is a number that runs from \(-4\) to \(+4\). The function \(\sigma( r_{ij} )\) is a <a class="el" href="switchingfunction.html">switchingfunction</a> that acts on the distance between atoms \(i\) and \(j\). The parameters of this function should be set so that it the function is equal to one when atom \(j\) is in the first coordination sphere of atom \(i\) and is zero otherwise.</p>
<p>The Steinhardt parameters can be used to measure the degree of order in the system in a variety of different ways. The simplest way of measuring whether or not the coordination sphere is ordered is to simply take the norm of the above vector i.e.</p>
<p class="formulaDsp">
\[ Q_4(i) = \sqrt{ \sum_{m=-4}^4 q_{4m}(i)^{*} q_{4m}(i) } \]
</p>
<p>This norm is small when the coordination shell is disordered and larger when the coordination shell is ordered. Furthermore, when the keywords LESS_THAN, MIN, MAX, HISTOGRAM, MEAN and so on are used with this colvar it is the distribution of these normed quantities that is investigated.</p>
<p>Other measures of order can be taken by averaging the components of the individual \(q_4\) vectors individually or by taking dot products of the \(q_{4}\) vectors on adjacent atoms. More information on these variables can be found in the documentation for <a class="el" href="_l_o_c_a_l__q4.html">LOCAL_Q4</a>, <a class="el" href="_l_o_c_a_l__a_v_e_r_a_g_e.html">LOCAL_AVERAGE</a> and <a class="el" href="_n_l_i_n_k_s.html">NLINKS</a>.</p>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>When the label of this action is used as the input for a second you are not referring to a scalar quantity as you are in regular collective variables. The label is used to reference the full set of quantities calculated by the action. This is usual when using <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a>. Generally when doing this the previously calculated multicolvar will be referenced using the DATA keyword rather than ARG.</p>
<p>This Action can be used to calculate the following scalar quantities directly. These quantities are calculated by employing the keywords listed below. These quantities can then be referenced elsewhere in the input file by using this Action's label followed by a dot and the name of the quantity. Some amongst them can be calculated multiple times with different parameters. In this case the quantities calculated can be referenced elsewhere in the input by using the name of the quantity followed by a numerical identifier e.g. <em>label</em>.lessthan-1, <em>label</em>.lessthan-2 etc. When doing this and, for clarity we have made the label of the components customizable. As such by using the LABEL keyword in the description of the keyword input you can customize the component name</p>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> vmean </b> </td><td width="10%"><b> VMEAN </b>  </td><td>the norm of the mean vector. The output component can be refererred to elsewhere in the input file by using the label.vmean   </td></tr>
<tr>
<td width="5%"><b> altmin </b> </td><td width="10%"><b> ALT_MIN </b>  </td><td>the minimum value. This is calculated using the formula described in the description of the keyword so as to make it continuous.   </td></tr>
<tr>
<td width="5%"><b> between </b> </td><td width="10%"><b> BETWEEN </b>  </td><td>the number/fraction of values within a certain range. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
<tr>
<td width="5%"><b> highest </b> </td><td width="10%"><b> HIGHEST </b>  </td><td>the lowest of the quantitities calculated by this action   </td></tr>
<tr>
<td width="5%"><b> lessthan </b> </td><td width="10%"><b> LESS_THAN </b>  </td><td>the number of values less than a target value. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
<tr>
<td width="5%"><b> lowest </b> </td><td width="10%"><b> LOWEST </b>  </td><td>the lowest of the quantitities calculated by this action   </td></tr>
<tr>
<td width="5%"><b> mean </b> </td><td width="10%"><b> MEAN </b>  </td><td>the mean value. The output component can be refererred to elsewhere in the input file by using the label.mean   </td></tr>
<tr>
<td width="5%"><b> min </b> </td><td width="10%"><b> MIN </b>  </td><td>the minimum value. This is calculated using the formula described in the description of the keyword so as to make it continuous.   </td></tr>
<tr>
<td width="5%"><b> moment </b> </td><td width="10%"><b> MOMENTS </b>  </td><td>the central moments of the distribution of values. The second moment would be referenced elsewhere in the input file using <em>label</em>.moment-2, the third as <em>label</em>.moment-3, etc.   </td></tr>
<tr>
<td width="5%"><b> morethan </b> </td><td width="10%"><b> MORE_THAN </b>  </td><td>the number of values more than a target value. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
</table>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SPECIES </b> </td><td>this keyword is used for colvars such as coordination number. In that context it specifies that plumed should calculate one coordination number for each of the atoms specified. Each of these coordination numbers specifies how many of the other specified atoms are within a certain cutoff of the central atom. You can specify the atoms here as another multicolvar action or using a MultiColvarFilter or ActionVolume action. When you do so the quantity is calculated for those atoms specified in the previous multicolvar. This is useful if you would like to calculate the Steinhardt parameter for those atoms that have a coordination number more than four for example   </td></tr>
</table>
<dl class="section user"><dt>Or alternatively by using</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SPECIESA </b> </td><td>this keyword is used for colvars such as the coordination number. In that context it species that plumed should calculate one coordination number for each of the atoms specified in SPECIESA. Each of these cooordination numbers specifies how many of the atoms specifies using SPECIESB is within the specified cutoff. As with the species keyword the input can also be specified using the label of another multicolvar   </td></tr>
<tr>
<td width="15%"><b> SPECIESB </b> </td><td>this keyword is used for colvars such as the coordination number. It must appear with SPECIESA. For a full explanation see the documentation for that keyword   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NN </b> </td><td>( default=12 ) The n parameter of the switching function   </td></tr>
<tr>
<td width="15%"><b> MM </b> </td><td>( default=0 ) The m parameter of the switching function; 0 implies 2*NN   </td></tr>
<tr>
<td width="15%"><b> D_0 </b> </td><td>( default=0.0 ) The d_0 parameter of the switching function   </td></tr>
<tr>
<td width="15%"><b> R_0 </b> </td><td>The r_0 parameter of the switching function   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) do the calculation in serial. Do not parallelize   </td></tr>
<tr>
<td width="15%"><b> LOWMEM </b> </td><td>( default=off ) lower the memory requirements   </td></tr>
<tr>
<td width="15%"><b> TIMINGS </b> </td><td>( default=off ) output information on the timings of the various parts of the calculation   </td></tr>
<tr>
<td width="15%"><b> VERBOSE </b> </td><td><p class="starttd">( default=off ) write a more detailed output  </p>
<p class="endtd"></p>
</td></tr>
</table>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SWITCH </b> </td><td>This keyword is used if you want to employ an alternative to the continuous swiching function defined above. The following provides information on the <a class="el" href="switchingfunction.html">switchingfunction</a> that are available. When this keyword is present you no longer need the NN, MM, D_0 and R_0 keywords.   </td></tr>
<tr>
<td width="15%"><b> MEAN </b> </td><td>take the mean of these variables. The final value can be referenced using <em>label</em>.mean. You can use multiple instances of this keyword i.e. MEAN1, MEAN2, MEAN3... The corresponding values are then referenced using <em>label</em>.mean-1, <em>label</em>.mean-2, <em>label</em>.mean-3...   </td></tr>
<tr>
<td width="15%"><b> LESS_THAN </b> </td><td>calculate the number of variables less than a certain target value. This quantity is calculated using \(\sum_i \sigma(s_i)\), where \(\sigma(s)\) is a <a class="el" href="switchingfunction.html">switchingfunction</a>. The final value can be referenced using <em>label</em>.lessthan. You can use multiple instances of this keyword i.e. LESS_THAN1, LESS_THAN2, LESS_THAN3... The corresponding values are then referenced using <em>label</em>.lessthan-1, <em>label</em>.lessthan-2, <em>label</em>.lessthan-3...   </td></tr>
<tr>
<td width="15%"><b> MORE_THAN </b> </td><td>calculate the number of variables more than a certain target value. This quantity is calculated using \(\sum_i 1.0 - \sigma(s_i)\), where \(\sigma(s)\) is a <a class="el" href="switchingfunction.html">switchingfunction</a>. The final value can be referenced using <em>label</em>.morethan. You can use multiple instances of this keyword i.e. MORE_THAN1, MORE_THAN2, MORE_THAN3... The corresponding values are then referenced using <em>label</em>.morethan-1, <em>label</em>.morethan-2, <em>label</em>.morethan-3...   </td></tr>
<tr>
<td width="15%"><b> VMEAN </b> </td><td>calculate the norm of the mean vector. The final value can be referenced using <em>label</em>.vmean. You can use multiple instances of this keyword i.e. VMEAN1, VMEAN2, VMEAN3... The corresponding values are then referenced using <em>label</em>.vmean-1, <em>label</em>.vmean-2, <em>label</em>.vmean-3...   </td></tr>
<tr>
<td width="15%"><b> BETWEEN </b> </td><td>calculate the number of values that are within a certain range. These quantities are calculated using kernel density estimation as described on <a class="el" href="histogrambead.html">histogrambead</a>. The final value can be referenced using <em>label</em>.between. You can use multiple instances of this keyword i.e. BETWEEN1, BETWEEN2, BETWEEN3... The corresponding values are then referenced using <em>label</em>.between-1, <em>label</em>.between-2, <em>label</em>.between-3...   </td></tr>
<tr>
<td width="15%"><b> HISTOGRAM </b> </td><td>calculate a discretized histogram of the distribution of values. This shortcut allows you to calculates NBIN quantites like BETWEEN. The final value can be referenced using <em>label</em>.histogram. You can use multiple instances of this keyword i.e. HISTOGRAM1, HISTOGRAM2, HISTOGRAM3... The corresponding values are then referenced using <em>label</em>.histogram-1, <em>label</em>.histogram-2, <em>label</em>.histogram-3...   </td></tr>
<tr>
<td width="15%"><b> MOMENTS </b> </td><td>calculate the moments of the distribution of collective variables. The \(m\)th moment of a distribution is calculated using \(\frac{1}{N} \sum_{i=1}^N ( s_i - \overline{s} )^m \), where \(\overline{s}\) is the average for the distribution. The moments keyword takes a lists of integers as input or a range. Each integer is a value of \(m\). The final calculated values can be referenced using moment- \(m\).   </td></tr>
<tr>
<td width="15%"><b> MIN </b> </td><td>calculate the minimum value. To make this quantity continuous the minimum is calculated using \( \textrm{min} = \frac{\beta}{ \log \sum_i \exp\left( \frac{\beta}{s_i} \right) } \) The value of \(\beta\) in this function is specified using (BETA= \(\beta\)) The final value can be referenced using <em>label</em>.min. You can use multiple instances of this keyword i.e. MIN1, MIN2, MIN3... The corresponding values are then referenced using <em>label</em>.min-1, <em>label</em>.min-2, <em>label</em>.min-3...   </td></tr>
<tr>
<td width="15%"><b> ALT_MIN </b> </td><td>calculate the minimum value. To make this quantity continuous the minimum is calculated using \( \textrm{min} = -\frac{1}{\beta} \log \sum_i \exp\left( -\beta s_i \right) \) The value of \(\beta\) in this function is specified using (BETA= \(\beta\)). The final value can be referenced using <em>label</em>.altmin. You can use multiple instances of this keyword i.e. ALT_MIN1, ALT_MIN2, ALT_MIN3... The corresponding values are then referenced using <em>label</em>.altmin-1, <em>label</em>.altmin-2, <em>label</em>.altmin-3...   </td></tr>
<tr>
<td width="15%"><b> LOWEST </b> </td><td>this flag allows you to recover the lowest of these variables. The final value can be referenced using <em>label</em>.lowest   </td></tr>
<tr>
<td width="15%"><b> HIGHEST </b> </td><td><p class="starttd">this flag allows you to recover the highest of these variables. The final value can be referenced using <em>label</em>.highest  </p>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following command calculates the average Q4 parameter for the 64 atoms in a box of Lennard Jones and prints this quantity to a file called colvar:</p>
<pre class="fragment">Q4 SPECIES=1-64 D_0=1.3 R_0=0.2 MEAN LABEL=q4
PRINT ARG=q4.mean FILE=colvar
</pre><p>The following command calculates the histogram of Q4 parameters for the 64 atoms in a box of Lennard Jones and prints these quantities to a file called colvar:</p>
<pre class="fragment">Q4 SPECIES=1-64 D_0=1.3 R_0=0.2 HISTOGRAM={GAUSSIAN LOWER=0.0 UPPER=1.0 NBINS=20 SMEAR=0.1} LABEL=q4
PRINT ARG=q4.* FILE=colvar
</pre><p>The following command could be used to measure the Q4 paramters that describe the arrangement of chlorine ions around the sodium atoms in NaCl. The imagined system here is composed of 64 NaCl formula units and the atoms are arranged in the input with the 64 Na \(^+\) ions followed by the 64 Cl \(-\) ions. Once again the average Q4 paramter is calculated and output to a file called colvar</p>
<pre class="fragment">Q4 SPECIESA=1-64 SPECIESB=65-128 D_0=1.3 R_0=0.2 MEAN LABEL=q4
PRINT ARG=q4.mean FILE=colvar
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective variables</a></li><li class="navelem"><a class="el" href="mcolv.html">MultiColvar</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
